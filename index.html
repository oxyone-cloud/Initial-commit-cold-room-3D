<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Oxyone - Jumeau Numérique Fix</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: sans-serif; }
        #panel {
            position: absolute; top: 20px; left: 20px;
            background: rgba(15, 15, 15, 0.9); color: white;
            padding: 20px; border-radius: 10px; border: 2px solid #00aaff;
            z-index: 10; width: 250px;
        }
        .label { font-size: 11px; color: #888; text-transform: uppercase; }
        .value { font-size: 22px; font-weight: bold; color: #00aaff; margin-bottom: 10px; }
        .alert { padding: 10px; border-radius: 5px; text-align: center; font-weight: bold; margin-top: 10px; border: 1px solid #333; }
        .danger { background: rgba(255, 0, 0, 0.3); color: #ff4444; border-color: #ff4444; }
        .ok { background: rgba(0, 255, 136, 0.1); color: #00ff88; }
        input { width: 100%; cursor: pointer; }
    </style>
</head>
<body>
    <div id="panel">
        <div class="label">Système Oxyone</div>
        <div id="alertBox" class="alert ok">SYSTÈME OK</div>
        <hr style="border:0; border-top:1px solid #333; margin:15px 0;">
        <div class="label">Température</div>
        <div id="tVal" class="value">4.0°C</div>
        <input type="range" id="tSlider" min="-20" max="40" value="4">
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        camera.position.set(15, 15, 20);

        scene.add(new THREE.AmbientLight(0xffffff, 1));
        const grid = new THREE.GridHelper(40, 40, 0x444444, 0x222222);
        scene.add(grid);

        // --- MATÉRIAUX ---
        const blueMat = new THREE.MeshStandardMaterial({ color: 0x00aaff, transparent: true, opacity: 0.2, side: THREE.DoubleSide });
        const greyMat = new THREE.MeshStandardMaterial({ color: 0x888888 });
        const blackMat = new THREE.MeshStandardMaterial({ color: 0x111111 });
        const whiteMat = new THREE.MeshStandardMaterial({ color: 0xffffff });

        // --- CHAMBRE (CUBE BLEU) ---
        const chamber = new THREE.Mesh(new THREE.BoxGeometry(10, 8, 10), blueMat);
        chamber.position.y = 4;
        chamber.renderOrder = 2; // Dessiné en dernier pour voir à travers
        scene.add(chamber);

        // --- STRUCTURE GRISE (Angles) ---
        function addPillar(x, z) {
            const p = new THREE.Mesh(new THREE.BoxGeometry(0.6, 8.1, 0.6), greyMat);
            p.position.set(x, 4, z);
            p.renderOrder = 1; 
            scene.add(p);
        }
        addPillar(5, 5); addPillar(-5, 5); addPillar(5, -5); addPillar(-5, -5);

        // --- PORTE NOIRE ---
        const door = new THREE.Mesh(new THREE.BoxGeometry(4, 6, 0.4), blackMat);
        door.position.set(0, 3, 5.1); // Un peu en avant du cube
        door.renderOrder = 1;
        scene.add(door);

        // --- MOTEUR EXTÉRIEUR ---
        const motor = new THREE.Mesh(new THREE.BoxGeometry(2, 2, 2), blackMat);
        motor.position.set(7, 1.5, 0);
        motor.renderOrder = 1;
        scene.add(motor);

        // --- ÉVAPORATEUR INTÉRIEUR ---
        const evap = new THREE.Mesh(new THREE.BoxGeometry(4, 1.2, 2), whiteMat);
        evap.position.set(0, 7, -3);
        evap.renderOrder = 1;
        scene.add(evap);

        // --- ÉTAGÈRES ---
        for(let h=2; h<7; h+=2.5) {
            const sG = new THREE.Mesh(new THREE.BoxGeometry(3, 0.1, 8), greyMat);
            sG.position.set(-3.2, h, 0);
            sG.renderOrder = 1;
            scene.add(sG);
        }

        // --- LOGIQUE SLIDER ---
        const slider = document.getElementById('tSlider');
        const tVal = document.getElementById('tVal');
        const alertBox = document.getElementById('alertBox');

        slider.addEventListener('input', () => {
            const v = slider.value;
            tVal.innerText = v + ".0°C";
            if(v > 15) {
                alertBox.innerText = "ALERTE !";
                alertBox.className = "alert danger";
                blueMat.color.setHex(0xff0000);
                blueMat.opacity = 0.5;
            } else {
                alertBox.innerText = "SYSTÈME OK";
                alertBox.className = "alert ok";
                blueMat.color.setHex(0x00aaff);
                blueMat.opacity = 0.2;
            }
        });

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
